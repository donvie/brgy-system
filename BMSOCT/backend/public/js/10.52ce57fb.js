(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[10],{"23ac":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-page",{attrs:{padding:""}},[a("q-table",{attrs:{title:e.filterTitle+" ("+e.residents.total+")","title-class":"q-mt-sm",data:e.residents.data,columns:e.columns,"row-key":"_id",pagination:e.pagination,loading:e.loading,"rows-per-page-options":[5,10,20,50,100],filter:e.filter,"binary-state-sort":""},on:{"update:pagination":function(t){e.pagination=t},request:e.onRequest},scopedSlots:e._u([{key:"body",fn:function(t){return[a("q-tr",{attrs:{props:t},nativeOn:{click:function(a){e.viewItemLayout=!0,e.itemDetails=t.row}}},[a("q-td",{key:"_id",attrs:{props:t}},[e._v("\n          "+e._s(t.rowIndex+1)+".\n        ")]),a("q-td",{key:"firstName",attrs:{props:t}},[e._v("\n          "+e._s(t.row.firstName)+"\n        ")]),a("q-td",{key:"middleName",attrs:{props:t}},[e._v("\n          "+e._s(t.row.middleName)+"\n        ")]),a("q-td",{key:"lastName",attrs:{props:t}},[e._v("\n          "+e._s(t.row.lastName)+"\n        ")]),a("q-td",{key:"gender",attrs:{props:t}},[e._v("\n          "+e._s(t.row.gender)+"\n        ")]),a("q-td",{key:"age",attrs:{props:t}},[e._v("\n          "+e._s(t.row.age)+"\n        ")]),a("q-td",{attrs:{align:"center"}},[a("div",{staticClass:"q-gutter-xs"},[a("q-btn",{attrs:{dense:"",icon:"find_in_page",color:"primary"},on:{click:function(a){e.addItemLayout=!0,e.resident=t.row,e.action="view"}}}),"Admin"===e.$user.role?a("q-btn",{attrs:{dense:"",icon:"edit",color:"secondary"},on:{click:function(a){e.addItemLayout=!0,e.resident=t.row,e.action="edit"}}}):e._e(),"Admin"===e.$user.role?a("q-btn",{attrs:{disable:"admin"===t.row.firstName,dense:"",icon:"delete",color:"negative"},on:{click:function(a){return e.removeResident(t.row._id)}}}):e._e()],1)])],1)]}},{key:"top-right",fn:function(){return["Admin"===e.$user.role?a("q-btn",{staticClass:"q-mr-md",attrs:{color:"secondary",icon:"add",label:"Add Resident"},on:{click:function(t){e.addItemLayout=!0,e.action="add"}}}):e._e(),a("q-input",{attrs:{dense:"",debounce:"300",placeholder:"Search"},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-icon",{attrs:{name:"search"}})]},proxy:!0}]),model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}})]},proxy:!0}])}),a("q-dialog",{on:{hide:function(t){e.resident={}}},model:{value:e.addItemLayout,callback:function(t){e.addItemLayout=t},expression:"addItemLayout"}},[a("q-layout",{staticClass:"bg-white",attrs:{view:"Lhh lpR fff",container:""}},[a("q-header",{staticClass:"bg-primary"},[a("q-toolbar",[a("q-toolbar-title",["view"===e.action?a("span",[e._v("View")]):e._e(),"add"===e.action?a("span",[e._v("Add")]):e._e(),"edit"===e.action?a("span",[e._v("Edit")]):e._e(),e._v(" Resident\n          ")]),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",round:"",dense:"",icon:"close"}})],1)],1),a("q-footer",{staticClass:"bg-white"},[a("q-toolbar",[a("q-toolbar-title"),"add"===e.action||"edit"===e.action?a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{icon:"save",color:"primary",label:"Save"},on:{click:function(t){return e.addResident()}}}):e._e()],1)],1),a("q-page-container",[a("q-page",{attrs:{padding:""}},[a("div",{staticClass:"q-col-gutter-xl"},[a("q-input",{attrs:{readonly:"view"===e.action,label:"First Name"},model:{value:e.resident.firstName,callback:function(t){e.$set(e.resident,"firstName",t)},expression:"resident.firstName"}}),a("q-input",{attrs:{readonly:"view"===e.action,label:"Middel Name"},model:{value:e.resident.middleName,callback:function(t){e.$set(e.resident,"middleName",t)},expression:"resident.middleName"}}),a("q-input",{attrs:{readonly:"view"===e.action,label:"Last Name"},model:{value:e.resident.lastName,callback:function(t){e.$set(e.resident,"lastName",t)},expression:"resident.lastName"}}),a("q-input",{attrs:{readonly:"view"===e.action,label:"Username"},model:{value:e.resident.email,callback:function(t){e.$set(e.resident,"email",t)},expression:"resident.email"}}),a("q-input",{attrs:{readonly:"view"===e.action,type:e.isPwd?"password":"text",label:"Password",rules:[function(e){return!!e||"Password is required"}]},scopedSlots:e._u([e.resident.password&&e.resident.password.length>0?{key:"append",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:e.isPwd?"visibility_off":"visibility"},on:{click:function(t){e.isPwd=!e.isPwd}}})]},proxy:!0}:null],null,!0),model:{value:e.resident.password,callback:function(t){e.$set(e.resident,"password",t)},expression:"resident.password"}}),a("q-input",{attrs:{readonly:"view"===e.action,type:"textarea",label:"Complete Address",placeholder:"Street/House No./Brgy./City/Province"},model:{value:e.resident.completeAddress,callback:function(t){e.$set(e.resident,"completeAddress",t)},expression:"resident.completeAddress"}}),a("q-input",{attrs:{readonly:"view"===e.action,type:"number",label:"Age"},model:{value:e.resident.age,callback:function(t){e.$set(e.resident,"age",t)},expression:"resident.age"}}),a("q-select",{attrs:{readonly:"view"===e.action,options:e.genderOptions,label:"Gender"},model:{value:e.resident.gender,callback:function(t){e.$set(e.resident,"gender",t)},expression:"resident.gender"}}),a("q-input",{attrs:{readonly:"view"===e.action,label:"Contact Number"},model:{value:e.resident.contactNumber,callback:function(t){e.$set(e.resident,"contactNumber",t)},expression:"resident.contactNumber"}}),a("q-select",{attrs:{readonly:"view"===e.action,options:e.positionOptions,label:"Position"},model:{value:e.resident.position,callback:function(t){e.$set(e.resident,"position",t)},expression:"resident.position"}}),a("q-select",{attrs:{readonly:"view"===e.action,options:e.roleOptions,label:"Role"},model:{value:e.resident.role,callback:function(t){e.$set(e.resident,"role",t)},expression:"resident.role"}})],1),"view"===e.action?a("q-markup-table",{staticClass:"q-mt-xl",attrs:{flat:"",bordered:""}},[a("thead",[a("tr",[a("th",{attrs:{colspan:"5"}},[a("div",{staticClass:"row no-wrap items-center"},[a("div",{staticClass:"text-h6"},[e._v("Blotter Records")])])])]),a("tr",[a("th",{staticClass:"text-left"},[e._v("Date")]),a("th",{staticClass:"text-left"},[e._v("Offense")])])]),a("tbody",e._l(e.blotterRecords,(function(t,n){return a("tr",{key:n},[a("td",{staticClass:"text-left"},[e._v(e._s(t.date))]),a("td",{staticClass:"text-left"},[e._v(e._s(t.offense))])])})),0)]):e._e()],1)],1)],1)],1)],1)},i=[],s=(a("7db0"),a("d3b7"),a("c740"),a("a434"),a("4de4"),{name:"PageIndex",data:function(){return{blotterRecords:[],isPwd:!0,action:"",addItemLayout:!1,genderOptions:["Male","Female"],positionOptions:["Brgy. Chairman","Kagawad","Brgy. Treasurer","Brgy. Secretary","Brgy. Member"],roleOptions:["Admin","User"],resident:{firstName:"",middleName:"",lastName:"",email:"",password:"",completeAddress:"",age:"",gender:null,contactNumber:"",position:"",role:"User"},residents:{data:[],total:0},filter:"",loading:!1,rowsPerPageData:[],pagination:{sortBy:null,descending:!1,page:1,rowsPerPage:20,rowsNumber:0},columns:[{name:"_id",align:"left",label:"No.",field:"_id",sortable:!0},{name:"firstName",align:"left",label:"First Name",field:"firstName",sortable:!0},{name:"middleName",align:"left",label:"Middle Name",field:"middleName",sortable:!0},{name:"lastName",align:"left",label:"Last Name",field:"lastName",sortable:!0},{name:"age",align:"left",label:"Age",field:"age",sortable:!0},{name:"gender",align:"left",label:"Gender",field:"gender",sortable:!0},{name:"",align:"center",label:"Action",field:"",sortable:!0}]}},mounted:function(){var e=this;this.queryDocument();var t={$limit:100};this.$feathersClient.service("blotter-records").find({query:t}).then((function(t){e.blotterRecords=t.data})).catch((function(e){}))},computed:{filterTitle:function(){return"Admin"===this.$user.role?"List of Barangay Residents":"List of Barangay Official"}},methods:{removeResident:function(e){var t=this;this.$q.dialog({title:"Confirm",position:"top",message:"Are you sure you want to delete?",persistent:!0,ok:{unelevated:!0,push:!1,color:"negative"},cancel:{flat:!0,color:"negative"}}).onOk((function(){t.$feathersClient.service("users").remove(e).then((function(a){var n=t.residents.data.findIndex((function(t){return t._id===e}));t.residents.data.splice(n,1),t.$q.notify({position:"top",color:"positive",timeout:2e3,icon:"check",message:"It has been successfully deleted."})}))})).onCancel((function(){})).onDismiss((function(){}))},addResident:function(){var e=this,t=this.resident;"add"===this.action?(t.createdAt=Date.now(),t.email=this.resident.email,t.password=this.resident.password,this.$feathersClient.service("users").create(t).then((function(t){e.residents.data.unshift(t),e.$q.notify({position:"top",color:"positive",timeout:2e3,icon:"check",message:"It has been successfully created."})}))):this.$feathersClient.service("users").patch(this.resident._id,t).then((function(t){e.$q.notify({position:"top",color:"positive",timeout:2e3,icon:"check",message:"It has been successfully updated."})}))},queryDocument:function(){this.onRequest({pagination:this.pagination,filter:void 0})},onRequest:function(e){var t=this;this.loading=!0;var a=(e.pagination.page-1)*e.pagination.rowsPerPage;this.pagination=e.pagination;var n={$limit:e.pagination.rowsPerPage,$skip:a,$sort:{createdAt:-1}};"User"===this.$user.role&&(n.role={$ne:"Admin"}),""!==this.filter&&(n.$search=this.filter),null!==e.pagination.sortBy&&(n.$sort={},n.$sort["".concat(e.pagination.sortBy)]=e.pagination.descending?1:-1),setTimeout((function(){t.$feathersClient.service("users").find({query:n}).then((function(e){t.residents=e,t.pagination.rowsNumber=e.total,t.loading=!1})).catch((function(e){console.error("Error",e),t.loading=!1}))}),300)}}}),o=s,r=a("2877"),l=a("9989"),d=a("eaac"),c=a("bd08"),u=a("db86"),p=a("9c40"),m=a("27f9"),f=a("0016"),b=a("24e8"),g=a("4d5a"),v=a("e359"),y=a("65c6"),w=a("6ac5"),h=a("7ff0"),q=a("09e3"),_=a("ddd8"),k=a("2bb1"),N=a("7f67"),$=a("eebe"),x=a.n($),C=Object(r["a"])(o,n,i,!1,null,null,null);t["default"]=C.exports;x()(C,"components",{QPage:l["a"],QTable:d["a"],QTr:c["a"],QTd:u["a"],QBtn:p["a"],QInput:m["a"],QIcon:f["a"],QDialog:b["a"],QLayout:g["a"],QHeader:v["a"],QToolbar:y["a"],QToolbarTitle:w["a"],QFooter:h["a"],QPageContainer:q["a"],QSelect:_["a"],QMarkupTable:k["a"]}),x()(C,"directives",{ClosePopup:N["a"]})}}]);