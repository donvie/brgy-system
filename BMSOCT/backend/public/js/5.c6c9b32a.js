(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[5],{3679:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-page",{attrs:{padding:""}},[n("q-table",{attrs:{title:"Barangay Revenues ("+e.revenues.total+")","title-class":"q-mt-sm",data:e.revenues.data,columns:e.columns,"row-key":"_id",pagination:e.pagination,loading:e.loading,"rows-per-page-options":[5,10,20,50,100],filter:e.filter,"binary-state-sort":""},on:{"update:pagination":function(t){e.pagination=t},request:e.onRequest},scopedSlots:e._u([{key:"body",fn:function(t){return[n("q-tr",{attrs:{props:t},nativeOn:{click:function(n){e.viewItemLayout=!0,e.itemDetails=t.row}}},[n("q-td",{key:"_id",attrs:{props:t}},[e._v("\n          "+e._s(t.rowIndex+1)+".\n        ")]),n("q-td",{key:"business",attrs:{props:t}},[e._v("\n          "+e._s(t.row.business)+"\n        ")]),n("q-td",{key:"tax",attrs:{props:t}},[e._v("\n          "+e._s(t.row.tax)+"\n        ")]),n("q-td",{attrs:{align:"center"}},[n("div",{staticClass:"q-gutter-xs"},[n("q-btn",{attrs:{dense:"",icon:"find_in_page",color:"primary"},on:{click:function(n){e.addItemLayout=!0,e.revenue=t.row,e.action="view"}}}),"Admin"===e.$user.role?n("q-btn",{attrs:{dense:"",icon:"edit",color:"secondary"},on:{click:function(n){e.addItemLayout=!0,e.revenue=t.row,e.action="edit"}}}):e._e(),"Admin"===e.$user.role?n("q-btn",{attrs:{dense:"",icon:"delete",color:"negative"},on:{click:function(n){return e.removeBarangayRevenue(t.row._id)}}}):e._e()],1)])],1)]}},{key:"top-right",fn:function(){return["Admin"===e.$user.role?n("q-btn",{staticClass:"q-mr-md",attrs:{color:"secondary",icon:"add",label:"Add Revenue"},on:{click:function(t){e.addItemLayout=!0,e.action="add"}}}):e._e(),n("q-input",{attrs:{dense:"",debounce:"300",placeholder:"Search"},scopedSlots:e._u([{key:"append",fn:function(){return[n("q-icon",{attrs:{name:"search"}})]},proxy:!0}]),model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}})]},proxy:!0}])}),n("q-dialog",{model:{value:e.addItemLayout,callback:function(t){e.addItemLayout=t},expression:"addItemLayout"}},[n("q-layout",{staticClass:"bg-white",attrs:{view:"Lhh lpR fff",container:""}},[n("q-header",{staticClass:"bg-primary"},[n("q-toolbar",[n("q-toolbar-title",[e._v("Add Revenue")]),n("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",round:"",dense:"",icon:"close"}})],1)],1),n("q-footer",{staticClass:"bg-white"},[n("q-toolbar",[n("q-toolbar-title"),"add"===e.action||"edit"===e.action?n("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{icon:"save",color:"primary",label:"Save"},on:{click:function(t){return e.addResident()}}}):e._e()],1)],1),n("q-page-container",[n("q-page",{attrs:{padding:""}},[n("div",{staticClass:"q-col-gutter-xl"},[n("q-input",{attrs:{label:"Business"},model:{value:e.revenue.business,callback:function(t){e.$set(e.revenue,"business",t)},expression:"revenue.business"}}),n("q-input",{attrs:{label:"Tax",type:"number"},model:{value:e.revenue.tax,callback:function(t){e.$set(e.revenue,"tax",t)},expression:"revenue.tax"}})],1)])],1)],1)],1)],1)},o=[],i=(n("c740"),n("a434"),n("7db0"),n("d3b7"),n("4de4"),{name:"PageIndex",data:function(){return{action:"",addItemLayout:!1,usersOptions:[],revenue:{business:"",tax:0},revenues:{data:[],total:0},filter:"",loading:!1,rowsPerPageData:[],pagination:{sortBy:null,descending:!1,page:1,rowsPerPage:20,rowsNumber:0},columns:[{name:"_id",align:"left",label:"No.",field:"_id",sortable:!0},{name:"business",align:"left",label:"Business",field:"user",sortable:!0},{name:"tax",align:"left",label:"Tax(%)",field:"tax",sortable:!0},{name:"",align:"center",label:"Action",field:"",sortable:!0}]}},mounted:function(){this.queryDocument(),this.loadUsers("")},methods:{removeBarangayRevenue:function(e){var t=this;this.$q.dialog({title:"Confirm",position:"top",message:"Are you sure you want to delete?",persistent:!0,ok:{unelevated:!0,push:!1,color:"negative"},cancel:{flat:!0,color:"negative"}}).onOk((function(){t.$feathersClient.service("barangay-revenues").remove(e).then((function(n){var a=t.revenues.data.findIndex((function(t){return t._id===e}));t.revenues.data.splice(a,1),t.$q.notify({position:"top",color:"positive",timeout:2e3,icon:"check",message:"It has been successfully deleted."})}))})).onCancel((function(){})).onDismiss((function(){}))},filterFnUsers:function(e,t){this.loadUsers(e),t()},loadUsers:function(e){var t=this,n={$limit:50,role:{$ne:"Admin"}};""!==e&&(n.$search=e),this.$feathersClient.service("users").find({query:n}).then((function(e){t.usersOptions=e.data})).catch((function(e){console.log(e)}))},addResident:function(){var e=this;"add"===this.action?(this.revenue.createdAt=Date.now(),this.$feathersClient.service("barangay-revenues").create(this.revenue).then((function(t){e.revenues.data.unshift(t),e.$q.notify({position:"top",color:"positive",timeout:2e3,icon:"check",message:"It has been successfully created."})}))):this.$feathersClient.service("barangay-revenues").patch(this.revenue._id,this.revenue).then((function(t){e.$q.notify({position:"top",color:"positive",timeout:2e3,icon:"check",message:"It has been successfully updated."})}))},queryDocument:function(){this.onRequest({pagination:this.pagination,filter:void 0})},onRequest:function(e){var t=this;this.loading=!0;var n=(e.pagination.page-1)*e.pagination.rowsPerPage;this.pagination=e.pagination;var a={$limit:e.pagination.rowsPerPage,$skip:n,role:{$ne:"Admin"},$sort:{createdAt:-1}};""!==this.filter&&(a.$search=this.filter),null!==e.pagination.sortBy&&(a.$sort={},a.$sort["".concat(e.pagination.sortBy)]=e.pagination.descending?1:-1),setTimeout((function(){t.$feathersClient.service("barangay-revenues").find({query:a}).then((function(e){t.revenues=e,t.pagination.rowsNumber=e.total,t.loading=!1})).catch((function(e){console.error("Error",e),t.loading=!1}))}),300)}}}),s=i,r=n("2877"),l=n("9989"),c=n("eaac"),u=n("bd08"),d=n("db86"),p=n("9c40"),f=n("27f9"),v=n("0016"),g=n("24e8"),m=n("4d5a"),b=n("e359"),h=n("65c6"),y=n("6ac5"),q=n("7ff0"),w=n("09e3"),k=n("7f67"),$=n("eebe"),_=n.n($),x=Object(r["a"])(s,a,o,!1,null,null,null);t["default"]=x.exports;_()(x,"components",{QPage:l["a"],QTable:c["a"],QTr:u["a"],QTd:d["a"],QBtn:p["a"],QInput:f["a"],QIcon:v["a"],QDialog:g["a"],QLayout:m["a"],QHeader:b["a"],QToolbar:h["a"],QToolbarTitle:y["a"],QFooter:q["a"],QPageContainer:w["a"]}),_()(x,"directives",{ClosePopup:k["a"]})}}]);