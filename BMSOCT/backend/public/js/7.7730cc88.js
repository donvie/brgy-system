(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[7],{fad9:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("q-page",{attrs:{padding:""}},[s("q-table",{attrs:{title:"Barangay Request List ("+e.requestLists.total+")","title-class":"q-mt-sm",data:e.requestLists.data,columns:e.columns,"row-key":"_id",pagination:e.pagination,loading:e.loading,"rows-per-page-options":[5,10,20,50,100],filter:e.filter,"binary-state-sort":""},on:{"update:pagination":function(t){e.pagination=t},request:e.onRequest},scopedSlots:e._u([{key:"body",fn:function(t){return[s("q-tr",{attrs:{props:t},nativeOn:{click:function(s){e.viewItemLayout=!0,e.itemDetails=t.row}}},[s("q-td",{key:"_id",attrs:{props:t}},[e._v("\n          "+e._s(t.rowIndex+1)+".\n        ")]),s("q-td",{key:"user",attrs:{props:t}},[e._v("\n          "+e._s(t.row.user.firstName)+" "+e._s(t.row.user.lastName)+"\n        ")]),s("q-td",{key:"type",attrs:{props:t}},[e._v("\n          "+e._s(t.row.type)+"\n        ")]),s("q-td",{key:"dateNeeded",attrs:{props:t}},[e._v("\n          "+e._s(t.row.dateNeeded)+"\n        ")]),s("q-td",{key:"status",attrs:{props:t}},[s("q-badge",{attrs:{color:"Pending"===t.row.status?"negative":"positive"}},[e._v("\n            "+e._s(t.row.status)+"\n          ")])],1),s("q-td",{key:"remarks",attrs:{props:t}},[e._v("\n          "+e._s(t.row.remarks)+"\n        ")]),s("q-td",{attrs:{align:"center"}},[s("div",{staticClass:"q-gutter-xs"},[s("q-btn",{attrs:{dense:"",icon:"find_in_page",color:"primary"},on:{click:function(s){e.addItemLayout=!0,e.requestList=t.row,e.action="view"}}}),"Admin"===e.$user.role?s("q-btn",{attrs:{disable:"Completed"===t.row.status,dense:"",icon:"check",color:"positive"},on:{click:function(s){e.requestList=t.row,e.tagAsCompleted()}}}):e._e(),"Admin"===e.$user.role?s("q-btn",{attrs:{dense:"",icon:"edit",color:"secondary"},on:{click:function(s){e.addItemLayout=!0,e.requestList=t.row,e.action="edit"}}}):e._e(),"Admin"===e.$user.role?s("q-btn",{attrs:{dense:"",icon:"delete",color:"negative"},on:{click:function(s){return e.removerequestList(t.row._id)}}}):e._e()],1)])],1)]}},{key:"top-right",fn:function(){return["User"===e.$user.role?s("q-btn",{staticClass:"q-mr-md",attrs:{color:"secondary",icon:"add",label:"Add Request"},on:{click:function(t){e.addItemLayout=!0,e.action="add"}}}):e._e(),s("q-input",{attrs:{dense:"",debounce:"300",placeholder:"Search"},scopedSlots:e._u([{key:"append",fn:function(){return[s("q-icon",{attrs:{name:"search"}})]},proxy:!0}]),model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}})]},proxy:!0}])}),s("q-dialog",{on:{hide:function(t){e.requestList={}}},model:{value:e.addItemLayout,callback:function(t){e.addItemLayout=t},expression:"addItemLayout"}},[s("q-layout",{staticClass:"bg-white",attrs:{view:"Lhh lpR fff",container:""}},[s("q-header",{staticClass:"bg-primary"},[s("q-toolbar",[s("q-toolbar-title",["view"===e.action?s("span",[e._v("View")]):e._e(),"add"===e.action?s("span",[e._v("Add")]):e._e(),"edit"===e.action?s("span",[e._v("Edit")]):e._e(),e._v(" Request\n          ")]),s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",round:"",dense:"",icon:"close"}})],1)],1),s("q-footer",{staticClass:"bg-white"},[s("q-toolbar",[s("q-toolbar-title"),"add"===e.action||"edit"===e.action?s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{icon:"save",color:"primary",label:"Save"},on:{click:function(t){return e.addrequestList()}}}):e._e()],1)],1),s("q-page-container",[s("q-page",{attrs:{padding:""}},[s("div",{staticClass:"q-col-gutter-xl"},[e.requestList.user?s("q-input",{attrs:{value:e.requestList.user.firstName+" "+e.requestList.user.lastName,readonly:"",label:"Name"}}):e._e(),e.requestList.user?s("q-input",{attrs:{value:e.requestList.user.comepleteAddress,readonly:"",label:"Complete Address"}}):e._e(),e.requestList.user?s("q-input",{attrs:{value:e.requestList.user.contactNumber,readonly:"",label:"Contact No."}}):e._e(),s("q-select",{attrs:{readonly:"view"===e.action,options:e.typeOptions,label:"Type"},model:{value:e.requestList.type,callback:function(t){e.$set(e.requestList,"type",t)},expression:"requestList.type"}}),s("q-input",{attrs:{readonly:"view"===e.action,type:"date","stack-label":"",label:"Date Needed"},model:{value:e.requestList.dateNeeded,callback:function(t){e.$set(e.requestList,"dateNeeded",t)},expression:"requestList.dateNeeded"}}),"view"===e.action?s("q-select",{attrs:{readonly:"view"===e.action,options:e.typeOptions,label:"Status"},model:{value:e.requestList.status,callback:function(t){e.$set(e.requestList,"status",t)},expression:"requestList.status"}}):e._e(),s("q-input",{attrs:{readonly:"view"===e.action,type:"textarea",label:"Remarks"},model:{value:e.requestList.remarks,callback:function(t){e.$set(e.requestList,"remarks",t)},expression:"requestList.remarks"}})],1)])],1)],1)],1)],1)},i=[],n=(s("c740"),s("a434"),s("7db0"),s("d3b7"),s("4de4"),{name:"PageIndex",data:function(){return{action:"",addItemLayout:!1,usersOptions:[],typeOptions:["Barangay Clearance","Barangay Business Clearance","Certificate of Indigency","Barangay ID"],requestList:{type:"",dateNeeded:null,remarks:""},requestLists:{data:[],total:0},filter:"",loading:!1,rowsPerPageData:[],pagination:{sortBy:null,descending:!1,page:1,rowsPerPage:20,rowsNumber:0},columns:[{name:"_id",align:"left",label:"No.",field:"_id",sortable:!0},{name:"user",align:"left",label:"Name",field:"user",sortable:!0},{name:"type",align:"left",label:"Type",field:"type",sortable:!0},{name:"dateNeeded",align:"left",label:"Date needed",field:"dateNeeded",sortable:!0},{name:"status",align:"left",label:"Status",field:"status",sortable:!0},{name:"remarks",align:"left",label:"Remarks",field:"remarks",sortable:!0},{name:"",align:"center",label:"Action",field:"",sortable:!0}]}},mounted:function(){this.queryDocument(),this.loadUsers("")},methods:{tagAsCompleted:function(){var e=this;this.$q.dialog({title:"Confirm",position:"top",message:"Are you sure you want to tag as completed?",persistent:!0,ok:{unelevated:!0,push:!1,color:"primary"},cancel:{flat:!0,color:"primary"}}).onOk((function(){e.requestList.status="Completed",e.$feathersClient.service("barangay-request-lists").patch(e.requestList._id,e.requestList).then((function(t){e.$q.notify({position:"top",color:"positive",timeout:2e3,icon:"check",message:"Success!."}),e.$forceUpdate()}))})).onCancel((function(){})).onDismiss((function(){}))},removerequestList:function(e){var t=this;this.$q.dialog({title:"Confirm",position:"top",message:"Are you sure you want to delete?",persistent:!0,ok:{unelevated:!0,push:!1,color:"negative"},cancel:{flat:!0,color:"negative"}}).onOk((function(){t.$feathersClient.service("barangay-request-lists").remove(e).then((function(s){var a=t.requestLists.data.findIndex((function(t){return t._id===e}));t.requestLists.data.splice(a,1),t.$q.notify({position:"top",color:"positive",timeout:2e3,icon:"check",message:"It has been successfully deleted."})}))})).onCancel((function(){})).onDismiss((function(){}))},filterFnUsers:function(e,t){this.loadUsers(e),t()},loadUsers:function(e){var t=this,s={$limit:50,role:{$ne:"Admin"}};""!==e&&(s.$search=e),this.$feathersClient.service("users").find({query:s}).then((function(e){t.usersOptions=e.data})).catch((function(e){console.log(e)}))},addrequestList:function(){var e=this;"add"===this.action?(this.requestList.createdAt=Date.now(),this.requestList.user=this.$user,this.requestList.status="Pending",this.$feathersClient.service("barangay-request-lists").create(this.requestList).then((function(t){e.requestLists.data.unshift(t),e.$q.notify({position:"top",color:"positive",timeout:2e3,icon:"check",message:"It has been successfully saved."})}))):this.$feathersClient.service("barangay-request-lists").patch(this.requestList._id,this.requestList).then((function(t){e.$q.notify({position:"top",color:"positive",timeout:2e3,icon:"check",message:"It has been successfully updated."})}))},queryDocument:function(){this.onRequest({pagination:this.pagination,filter:void 0})},onRequest:function(e){var t=this;this.loading=!0;var s=(e.pagination.page-1)*e.pagination.rowsPerPage;this.pagination=e.pagination;var a={$limit:e.pagination.rowsPerPage,$skip:s,$sort:{createdAt:-1,status:-1}};"User"===this.$user.role&&(a["user._id"]=this.$user._id),""!==this.filter&&(a.$search=this.filter),null!==e.pagination.sortBy&&(a.$sort={},a.$sort["".concat(e.pagination.sortBy)]=e.pagination.descending?1:-1),setTimeout((function(){t.$feathersClient.service("barangay-request-lists").find({query:a}).then((function(e){t.requestLists=e,t.pagination.rowsNumber=e.total,t.loading=!1})).catch((function(e){console.error("Error",e),t.loading=!1}))}),300)}}}),o=n,r=s("2877"),l=s("9989"),u=s("eaac"),c=s("bd08"),d=s("db86"),p=s("58a81"),f=s("9c40"),q=s("27f9"),m=s("0016"),g=s("24e8"),y=s("4d5a"),b=s("e359"),h=s("65c6"),v=s("6ac5"),L=s("7ff0"),k=s("09e3"),w=s("ddd8"),_=s("7f67"),$=s("eebe"),C=s.n($),N=Object(r["a"])(o,a,i,!1,null,null,null);t["default"]=N.exports;C()(N,"components",{QPage:l["a"],QTable:u["a"],QTr:c["a"],QTd:d["a"],QBadge:p["a"],QBtn:f["a"],QInput:q["a"],QIcon:m["a"],QDialog:g["a"],QLayout:y["a"],QHeader:b["a"],QToolbar:h["a"],QToolbarTitle:v["a"],QFooter:L["a"],QPageContainer:k["a"],QSelect:w["a"]}),C()(N,"directives",{ClosePopup:_["a"]})}}]);